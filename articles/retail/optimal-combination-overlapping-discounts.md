---
title: Ákvarða bestu samsetningu afsláttar sem skarast
description: Þegar afsláttur skarast, verður að ákvarða samsetningu afsláttar sem skarast, sem mun skapa lægstu heildarupphæð færslunnar eða hæsta heildarafslátt. Þegar afsláttarupphæð er breytileg eftir verði afurða sem eru keyptar, eins og hinn algengi smásöluafsláttur „Keyptu 1, fáðu 1 X prósent afslátt“ (BOGO), snýst þetta ferli um fínstillingu á samsetningum.
author: kfend
manager: AnnBe
ms.date: 06/20/2017
ms.topic: article
ms.prod: ''
ms.service: dynamics-365-retail
ms.technology: ''
ms.search.form: RetailParameters, RetailPeriodicDiscount,
audience: Application User, IT Pro
ms.reviewer: kfend
ms.search.scope: Core, Operations, Retail
ms.custom: 89643
ms.assetid: 09843c9a-3e19-4e4a-a8ce-80650f2095f9
ms.search.region: global
ms.search.industry: Retail
ms.author: kfend
ms.search.validFrom: 2016-05-31
ms.dyn365.ops.version: AX 7.0.1
ms.openlocfilehash: eebb532071e7c6bae7cfae93bfe795e79bb16c63
ms.sourcegitcommit: 9d4c7edd0ae2053c37c7d81cdd180b16bf3a9d3b
ms.translationtype: HT
ms.contentlocale: is-IS
ms.lasthandoff: 05/15/2019
ms.locfileid: "1564996"
---
# <a name="determine-the-optimal-combination-of-overlapping-discounts"></a><span data-ttu-id="3318f-104">Ákvarða bestu samsetningu afsláttar sem skarast</span><span class="sxs-lookup"><span data-stu-id="3318f-104">Determine the optimal combination of overlapping discounts</span></span>

[!include [banner](includes/banner.md)]

<span data-ttu-id="3318f-105">Þegar afsláttur skarast, verður að ákvarða samsetningu afsláttar sem skarast, sem mun skapa lægstu heildarupphæð færslunnar eða hæsta heildarafslátt.</span><span class="sxs-lookup"><span data-stu-id="3318f-105">When discounts overlap, you must determine the combination of overlapping discounts that will produce the lowest transaction total or the highest total discount.</span></span> <span data-ttu-id="3318f-106">Þegar afsláttarupphæð er breytileg eftir verði afurða sem eru keyptar, eins og hin algenga „Keyptu 1, fáðu 1 X prósent afslátt“ smásöluafslátt (BOGO), verður þetta ferli vandamál fínstillingar á samsetningum.</span><span class="sxs-lookup"><span data-stu-id="3318f-106">When the discount amount varies according to the price of the products that are purchased, such as in the common "Buy 1, get 1 X percent off" (BOGO) retail discount, this process becomes an issue of combinatorial optimization.</span></span>

<span data-ttu-id="3318f-107">Þessi grein á við um Microsoft Dynamics AX 2012 R3 með KB 3105973 (gefin út 2. nóvember 2015) eða síðar og við Microsoft Dynamics 365 for Retail.</span><span class="sxs-lookup"><span data-stu-id="3318f-107">This article applies to Microsoft Dynamics AX 2012 R3 with KB 3105973 (released November 2, 2015) or later, and to Microsoft Dynamics 365 for Retail.</span></span> <span data-ttu-id="3318f-108">Við höfum innleitt aðferð til að nota afslætti sem skarast, til að hægt sé að ákvarða samsetningu afsláttar sem skarast tímanlega.</span><span class="sxs-lookup"><span data-stu-id="3318f-108">To determine the combination overlapping discounts to apply in a timely manner, we have introduced a method for applying overlapping discounts.</span></span> <span data-ttu-id="3318f-109">Við köllum þessa nýju aðferð **Röðun jaðarvirðis**.</span><span class="sxs-lookup"><span data-stu-id="3318f-109">We call this new method **marginal value ranking**.</span></span> <span data-ttu-id="3318f-110">Röðun jaðarvirðis er notuð þegar tíminn sem er nauðsynlegur til að meta mögulegar samsetningar á afslætti sem skarast fer yfir þröskuld sem er gerður skilgreinanlegur á síðunni **Færibreytur í Retail**.</span><span class="sxs-lookup"><span data-stu-id="3318f-110">Marginal value ranking is used when the time that is required in order to evaluate the possible combinations of overlapping discounts exceeds a threshold that is configurable on the **Retail parameters** page.</span></span> <span data-ttu-id="3318f-111">Í röðun jaðarvirðis, er virði reiknað fyrir hvern afslátt sem skarast með því að nota virði afsláttar á samnýttar afurðir.</span><span class="sxs-lookup"><span data-stu-id="3318f-111">In the marginal value ranking method, a value is calculated for each overlapping discount by using the discount's value on the shared products.</span></span> <span data-ttu-id="3318f-112">Afsláttur sem skarast gildir síðan úr tengdu hæsta hlutfallslega virði gegn lægsta hlutfallslega virði.</span><span class="sxs-lookup"><span data-stu-id="3318f-112">The overlapped discounts are then applied from the highest relative value to the lowest relative value.</span></span> <span data-ttu-id="3318f-113">Nánari upplýsingar um nýju greiðsluaðferðina er að finna í hlutanum „Jaðarvirði" síðar í þessari grein.</span><span class="sxs-lookup"><span data-stu-id="3318f-113">For details about the new method, see the "Marginal value" section, later in this article.</span></span> <span data-ttu-id="3318f-114">Röðun jaðarvirðis er ekki notað þegar afsláttarupphæðir afurðar verða ekki fyrir áhrifum af annarri afurð í færslunni.</span><span class="sxs-lookup"><span data-stu-id="3318f-114">Marginal value ranking isn't used when the discount amounts for a product aren't affected by another product in the transaction.</span></span> <span data-ttu-id="3318f-115">Til dæmis er þessi aðferð ekki notuð fyrir tvo einfalda afslætti eða fyrir einfaldan afslátt og magnafslátt einnar afurðar.</span><span class="sxs-lookup"><span data-stu-id="3318f-115">For example, this method isn't used for two simple discounts, or for a simple discount and a single product quantity discount.</span></span>

## <a name="discount-examples"></a><span data-ttu-id="3318f-116">Dæmi um afslætti</span><span class="sxs-lookup"><span data-stu-id="3318f-116">Discount examples</span></span>

<span data-ttu-id="3318f-117">Hægt er að stofna ótakmarkaðan fjölda af smásöluafsláttum í sameiginlegu safni afurða.</span><span class="sxs-lookup"><span data-stu-id="3318f-117">You can create an unlimited number of retail discounts on a common set of products.</span></span> <span data-ttu-id="3318f-118">Hins vegar, þar sem engin takmörk eru geta afkastavandamál átt sér stað þegar reynt er að reikna út afslætti sem nota á mismunandi afurðir.</span><span class="sxs-lookup"><span data-stu-id="3318f-118">However, because there is no limit, performance issues can occur when you try to calculate the discounts that should be used on the various products.</span></span> <span data-ttu-id="3318f-119">Eftirfarandi dæmi sýna vandamálið nánar.</span><span class="sxs-lookup"><span data-stu-id="3318f-119">The following examples illustrate this issue in more detail.</span></span> <span data-ttu-id="3318f-120">Í dæmi 1 er byrjum við með tvær vörur og tvo afslætti sem skarast.</span><span class="sxs-lookup"><span data-stu-id="3318f-120">In example 1, we start with two products and two overlapping discounts.</span></span> <span data-ttu-id="3318f-121">Síðan, í dæmi 2 mælt er sýnt hvernig vandamálið þróast eftir því sem fleiri afurðum er bætt við.</span><span class="sxs-lookup"><span data-stu-id="3318f-121">Then, in example 2, we show how the issue evolves as more products are added.</span></span>

### <a name="example-1-two-products-and-two-discounts"></a><span data-ttu-id="3318f-122">Dæmi 1: Tvær vörur og tveir afslættir</span><span class="sxs-lookup"><span data-stu-id="3318f-122">Example 1: Two products and two discounts</span></span>

<span data-ttu-id="3318f-123">Í þessu dæmi eru tvær afurðir nauðsynlegar til þess að vera hæfar fyrir hvern afslátt og ekki er hægt að sameina afslættina.</span><span class="sxs-lookup"><span data-stu-id="3318f-123">In this example, two products are required in order to qualify for each discount, and the discounts can't be combined.</span></span> <span data-ttu-id="3318f-124">Afslættir í þessu dæmi eru afslættir af **Besta verð**.</span><span class="sxs-lookup"><span data-stu-id="3318f-124">The discounts in this example are **Best price** discounts.</span></span> <span data-ttu-id="3318f-125">Báðar afurðir eru hæfar fyrir báða afslætti.</span><span class="sxs-lookup"><span data-stu-id="3318f-125">Both products qualify for both discounts.</span></span> <span data-ttu-id="3318f-126">Hér eru þessir tveir afslættir.</span><span class="sxs-lookup"><span data-stu-id="3318f-126">Here are the two discounts.</span></span>

![Samsetning afslátta sem skarast 01](./media/overlapping-discount-combo-01.jpg)

<span data-ttu-id="3318f-128">Fyrir hvaða tvær afurðir sem er, fer sá betri af tveimur afsláttum eftir verðum afurðanna tveggja.</span><span class="sxs-lookup"><span data-stu-id="3318f-128">For any two products, the better of these two discounts depends on the prices of the two products.</span></span> <span data-ttu-id="3318f-129">Þegar verð bæði afurðir er jafnt og eða nánast það sama er betra afsláttur 1.</span><span class="sxs-lookup"><span data-stu-id="3318f-129">When the price of both products is equal or almost equal, discount 1 is better.</span></span> <span data-ttu-id="3318f-130">Þegar verð einni afurð er mikil minna en verð á vöru, er betra afsláttur 2.</span><span class="sxs-lookup"><span data-stu-id="3318f-130">When the price of one product is significantly less than the price of the other product, discount 2 is better.</span></span> <span data-ttu-id="3318f-131">Hér er stærðfræðileg regla fyrir mat á þessum tveimur afsláttum gagnvart hvor öðrum.</span><span class="sxs-lookup"><span data-stu-id="3318f-131">Here is the mathematical rule for evaluating these two discounts against each other.</span></span>

![Samsetning afslátta sem skarast 02](./media/overlapping-discount-combo-02.jpg)

> [!NOTE]
> <span data-ttu-id="3318f-133">Þegar verð afurðar 1 jafnast á við tvo þriðju hluta af verði afurðar 2, eru þessir tveir afslættir jafnir.</span><span class="sxs-lookup"><span data-stu-id="3318f-133">When the price of product 1 is equal to two-thirds of the price of product 2, the two discounts are equal.</span></span> <span data-ttu-id="3318f-134">Í þessu dæmi, er gild afsláttarprósenta fyrir afslátt 1 breytileg um nokkur prósent (þegar mikill munur er á verði afurðanna tveggja) að hámarki 25 prósent (þegar afurðnar tvær hafa sama verð).</span><span class="sxs-lookup"><span data-stu-id="3318f-134">In this example, the effective discount percentage for discount 1 varies from a few percent (when the prices of the two products are far apart) to a maximum of 25 percent (when the two products have the same price).</span></span> <span data-ttu-id="3318f-135">Gildi afsláttarprósentu fyrir afslátt 2 er föst.</span><span class="sxs-lookup"><span data-stu-id="3318f-135">The effective discount percentage for discount 2 is fixed.</span></span> <span data-ttu-id="3318f-136">Það er alltaf 20 prósent.</span><span class="sxs-lookup"><span data-stu-id="3318f-136">It's always 20 percent.</span></span> <span data-ttu-id="3318f-137">Þar sem gildi afsláttarprósentu fyrir afslátt 1 hefur svið sem getur verið meira en eða minna en 2 afsláttur, fer besti afslátturinn eftir verði afurðanna tveggja sem verða að hafa afslátt.</span><span class="sxs-lookup"><span data-stu-id="3318f-137">Because the effective discount percentage for discount 1 has a range that can be more than or less than discount 2, the best discount depends on the prices of the two products that must be discounted.</span></span> <span data-ttu-id="3318f-138">Í þessu dæmi er útreikningi lokið á fljótlegan hátt, þar sem aðeins þessum tveimur afsláttum er beitt á aðeins tvær afurðir.</span><span class="sxs-lookup"><span data-stu-id="3318f-138">In this example, the calculation is completed quickly, because only two discounts are applied on only two products.</span></span> <span data-ttu-id="3318f-139">Það eru tvær aðeins mögulegar samsetningar: ein notkun á afsláttur 1 eða ein notkun á afsláttar 2.</span><span class="sxs-lookup"><span data-stu-id="3318f-139">There are only two possible combinations: one application of discount 1 or one application of discount 2.</span></span> <span data-ttu-id="3318f-140">Það er engin umröðun til að reikna.</span><span class="sxs-lookup"><span data-stu-id="3318f-140">There are no permutations to calculate.</span></span> <span data-ttu-id="3318f-141">Virði hvors afsláttar er reiknað með því að nota báðar afurðir og besti afslátturinn er notaður.</span><span class="sxs-lookup"><span data-stu-id="3318f-141">The value of each discount is calculated by using both products, and the best discount is used.</span></span>

### <a name="example-2-four-products-and-two-discounts"></a><span data-ttu-id="3318f-142">Dæmi 2: Fjórar vörur og tveir afslættir</span><span class="sxs-lookup"><span data-stu-id="3318f-142">Example 2: Four products and two discounts</span></span>

<span data-ttu-id="3318f-143">Næst notum við fjórar afurðir og sama þessum tveimur afsláttum.</span><span class="sxs-lookup"><span data-stu-id="3318f-143">Next, we will use four products and the same two discounts.</span></span> <span data-ttu-id="3318f-144">Allar fjórar afurðirnar eru hæfar fyrir báða afslætti.</span><span class="sxs-lookup"><span data-stu-id="3318f-144">All four products qualify for both discounts.</span></span> <span data-ttu-id="3318f-145">Það eru tólf mögulegar samsetningar.</span><span class="sxs-lookup"><span data-stu-id="3318f-145">There are twelve possible combinations.</span></span> <span data-ttu-id="3318f-146">Í lokin verða tveir afsláttum notað í færslunni í einni af þremur samsetningum: tvær beitingar á afslætti 1, tvær beitingar afslætti 2, eða ein beiting á afslætti 1 og ein beiting á afslætti 2.</span><span class="sxs-lookup"><span data-stu-id="3318f-146">In the end, two discounts will be applied to the transaction in one of three combinations: two applications of discount 1, two applications of discount 2, or one application of discount 1 and one application of discount 2.</span></span> <span data-ttu-id="3318f-147">Til að sýna mögulegar samsetningar, lítum við þvínæst á tvö mismunandi pör fjögurra afurða sem hafa mismunandi verð:</span><span class="sxs-lookup"><span data-stu-id="3318f-147">To illustrate the possible combinations, we will look at two different sets of four products that have different prices:</span></span>

- <span data-ttu-id="3318f-148">Allar fjórar afurðir hafa sama verð $15,00.</span><span class="sxs-lookup"><span data-stu-id="3318f-148">All four products have the same price, $15.00.</span></span> <span data-ttu-id="3318f-149">Í þessu tilfelli er besta samsetning afsláttur tvær beitingar á afsláttar 1.</span><span class="sxs-lookup"><span data-stu-id="3318f-149">In this case, the best discount combination is two applications of discount 1.</span></span> <span data-ttu-id="3318f-150">Tvær afurðir verða á fullu verði og tvær verða með 50 prósent afslætti.</span><span class="sxs-lookup"><span data-stu-id="3318f-150">Two products will be full price, and two will be 50 percent off.</span></span> <span data-ttu-id="3318f-151">Samtala með afslætti færslunnar er $45 (15 + 15 + 7,50 + 7,50), sem er $15 (25 prósent) af samtala $60 án afsláttar.</span><span class="sxs-lookup"><span data-stu-id="3318f-151">The discounted total for the transaction is $45 (15 + 15 + 7.50 + 7.50), which is $15 (25 percent) off the undiscounted total of $60.</span></span> <span data-ttu-id="3318f-152">Afsláttur 2 er aðeins $12 (20 prósent).</span><span class="sxs-lookup"><span data-stu-id="3318f-152">Discount 2 is only $12 (20 percent).</span></span>
- <span data-ttu-id="3318f-153">Tvær afurðir eru $20 hvor, ein afurð er $15 og ein afurð er $5.</span><span class="sxs-lookup"><span data-stu-id="3318f-153">Two products are $20 each, one product is $15, and one product is $5.</span></span> <span data-ttu-id="3318f-154">Í þessu tilfelli er besta afsláttarsamsetningin ein beiting á afsláttur 2 og ein beiting á afsláttar 1.</span><span class="sxs-lookup"><span data-stu-id="3318f-154">In this case, the best discount combination is one application of discount 2 and one application of discount 1.</span></span> <span data-ttu-id="3318f-155">Eftirfarandi töflur sýnir afslættina.</span><span class="sxs-lookup"><span data-stu-id="3318f-155">The following tables illustrates the discounts.</span></span>

<span data-ttu-id="3318f-156">Til að lesa töflurnar þarf að nota eina afurð úr línu og eina vöru úr dálki.</span><span class="sxs-lookup"><span data-stu-id="3318f-156">To read the tables, use one product from a row and one product from a column.</span></span> <span data-ttu-id="3318f-157">Til dæmis í töflunni fyrir afslátt 1, þegar tvær $20 afurðir eru sameinaðar færðu $10 í afslátt.</span><span class="sxs-lookup"><span data-stu-id="3318f-157">For example, in the table for discount 1, when you combine the two $20 products, you get $10 off.</span></span> <span data-ttu-id="3318f-158">Til dæmis í töflunni fyrir afslátt 2, þegar $15 afurð og $5 afurð eru sameinaðar færðu $4 í afslátt.</span><span class="sxs-lookup"><span data-stu-id="3318f-158">In the table for discount 2, when you combine the $15 product and the $5 product, you get $4 off.</span></span>

![Samsetning afslátta sem skarast 03](./media/overlapping-discount-combo-03.jpg)

<span data-ttu-id="3318f-160">Fyrst finnum við hæsta afsláttinn sem er í boði úr hvaða tveimur afurðum sem er með því að nota annan hvorn afsláttinn.</span><span class="sxs-lookup"><span data-stu-id="3318f-160">First, we find the largest discount that is available from any two products by using either discount.</span></span> <span data-ttu-id="3318f-161">Töflurnar tvær sýna afsláttarupphæð fyrir allar samsetningar á afurðunum tveimur.</span><span class="sxs-lookup"><span data-stu-id="3318f-161">The two tables show the discount amount for all combinations of the two products.</span></span> <span data-ttu-id="3318f-162">Skyggðu hlutar töflunnar tákna annaðhvort tilfelli þar sem afurð er pöruð með sjálfri sér, sem við getum ekki gert, eða er bakfærð pörun tveggja afurða sem verður að sömu afsláttarupphæð og má hunsa.</span><span class="sxs-lookup"><span data-stu-id="3318f-162">The shaded portions of the tables represent either cases where a product is paired with itself, which we can't do, or a reverse pairing of two products that produces the same discount amount and can be ignored.</span></span> <span data-ttu-id="3318f-163">Með því að líta á töflur, hægt er að sjá að afsláttur 1 fyrir tvær vörur á $20 er stærsti afsláttar sem er tiltækt fyrir annað hvort afslætti á allar fjórar afurðir.</span><span class="sxs-lookup"><span data-stu-id="3318f-163">By looking at the tables, you can see that discount 1 for the two $20 items is the largest discount that is available for either discount on all four products.</span></span> <span data-ttu-id="3318f-164">(Þessi afsláttur er upplýstur með grænu í fyrstu töflunni.) Þá eru aðeins $15 afurðin og $5 afurðin eftir.</span><span class="sxs-lookup"><span data-stu-id="3318f-164">(This discount is highlighted in green in the first table.) That leaves only the $15 product and the $5 product.</span></span> <span data-ttu-id="3318f-165">Með því að líta á tvær töflurnar aftur er hægt að sjá að fyrir þessar tvær afurðir veitir afsláttur 1 $2,50 afslátt, en afsláttur 2 veitir aftur á móti $4 afslátt.</span><span class="sxs-lookup"><span data-stu-id="3318f-165">By looking at the two tables again, you can see that, for these two products, discount 1 gives a $2.50 discount, whereas discount 2 gives a $4 discount.</span></span> <span data-ttu-id="3318f-166">Þess vegna veljum við afslátt 2.</span><span class="sxs-lookup"><span data-stu-id="3318f-166">Therefore, we select discount 2.</span></span> <span data-ttu-id="3318f-167">Heildarafslátturinn er $14.</span><span class="sxs-lookup"><span data-stu-id="3318f-167">The total discount is $14.</span></span> <span data-ttu-id="3318f-168">Til að auðvelda að gera þessa umræðu sér í hugarlund eru hér tvær viðbótartöflur sem sýna gildi afsláttarprósentu fyrir allar mögulegar tveggja afurða samsetningar fyrir bæði afsláttur 1 og 2 afsláttar.</span><span class="sxs-lookup"><span data-stu-id="3318f-168">To make this discussion easier to visualize, here are two additional tables that show the effective discount percentage for all possible two-product combinations for both discount 1 and discount 2.</span></span> <span data-ttu-id="3318f-169">Aðeins helmingurinn af lista með samsetningum er hafður með, því að fyrir þessa tvo afslætti skiptir ekki máli í hvaða röð í afslættinum afurðirnar tvær eru settar í.</span><span class="sxs-lookup"><span data-stu-id="3318f-169">Only half the list of combinations is included, because, for these two discounts, the order in which the two products are put into the discount doesn't matter.</span></span> <span data-ttu-id="3318f-170">Hæsta gildi afsláttar (25%) er upplýst í grænu og lægsta gildi afsláttar (10 prósent) er upplýstur rauður.</span><span class="sxs-lookup"><span data-stu-id="3318f-170">The highest effective discount (25 percent) is highlighted in green, and the lowest effective discount (10 percent) is highlighted in red.</span></span>

![Samsetning afslátta sem skarast 04](./media/overlapping-discount-combo-04.jpg)

> [!NOTE]
> <span data-ttu-id="3318f-172">Þegar verð eru mismunandi og tveir eða fleiri afslættir keppa, er eina leiðin til að tryggja bestu samsetningu af afsláttum er að meta báða afslætti og bera þá saman.</span><span class="sxs-lookup"><span data-stu-id="3318f-172">When prices vary, and two or more discount compete, the only way to guarantee the best combination of discounts is to evaluate both discounts and compare them.</span></span>

## <a name="total-possible-combinations"></a><span data-ttu-id="3318f-173">Mögulegar samsetningar alls</span><span class="sxs-lookup"><span data-stu-id="3318f-173">Total possible combinations</span></span>

<span data-ttu-id="3318f-174">Þessi hluti heldur áfram með dæmi úr fyrri kafla.</span><span class="sxs-lookup"><span data-stu-id="3318f-174">This section continues the example from the previous section.</span></span> <span data-ttu-id="3318f-175">Við munum bæta við fleiri afurðum og öðrum afslætti og sjá hversu margar samsetningar er hægt að reikna út og bera saman.</span><span class="sxs-lookup"><span data-stu-id="3318f-175">We will add more products and another discount, and see how many combinations must be calculated and compared.</span></span> <span data-ttu-id="3318f-176">Eftirfarandi tafla sýnir fjölda mögulegra afsláttarsamsetninga eftir því sem afurðarmagn hækkar.</span><span class="sxs-lookup"><span data-stu-id="3318f-176">The following table shows the number of possible discount combinations as the product quantity increases.</span></span> <span data-ttu-id="3318f-177">Taflan sýnir hvað gerist bæði þegar það eru tveir afslættir sem skarast, eins og í fyrra dæmi, og þegar það eru þrír afslættir sem skarast.</span><span class="sxs-lookup"><span data-stu-id="3318f-177">The table shows what happens both when there are two overlapping discounts, as in the previous example, and when there are three overlapping discounts.</span></span> <span data-ttu-id="3318f-178">Fjöldi mögulegar afsláttarsamsetningar sem þarf að meta fljótlega fer yfir það sem jafnvel fljótvirk tölva getur reiknað út og borið saman nógu fljótt til að vera viðunandi fyrir smásölufærslur.</span><span class="sxs-lookup"><span data-stu-id="3318f-178">The number of possible discount combinations that must be evaluated soon exceeds what even a fast computer can calculate and compare quickly enough to be acceptable for retail transactions.</span></span>

![Samsetning afslátta sem skarast 05](./media/overlapping-discount-combo-05.jpg)

<span data-ttu-id="3318f-180">Þegar enn fleiri afslættir sem skarast eru notaðir, fer heildarfjöldi mögulegra afsláttasamsetninga fljótlega í milljónir, og tíminn sem þarf til að meta og velja bestu mögulegu samsetninguna verður fljótlega tilfinnanlegur.</span><span class="sxs-lookup"><span data-stu-id="3318f-180">When even larger quantities or more overlapping discounts are applied, the total number of possible discount combinations quickly goes into the millions, and the time that is required in order to evaluate and select the best possible combination quickly becomes noticeable.</span></span> <span data-ttu-id="3318f-181">Einhver fínstilling hefur verið gert í smásöluverðsvélinni til að draga úr þeim heildarfjölda samsetninga sem þarf að meta.</span><span class="sxs-lookup"><span data-stu-id="3318f-181">Some optimizations have been done in the retail price engine to reduce the total number of combinations that must be evaluated.</span></span> <span data-ttu-id="3318f-182">Hins vegar, þar sem fjöldi afslátta sem skarast og magns í færslu eru ekki takmörkuð, mun mikill fjöldi samsetninga alltaf verða að vera metinn í hvert skipti sem afslættir skarast.</span><span class="sxs-lookup"><span data-stu-id="3318f-182">However, because the number overlapping discounts and the quantities in a transaction aren't limited, a large number of combinations will always have to be evaluated whenever there are overlapping discounts.</span></span> <span data-ttu-id="3318f-183">Þetta vandamál er vandamál sem aðferð röðunar jaðarvirðis tekur á.</span><span class="sxs-lookup"><span data-stu-id="3318f-183">This issue is the issue that the marginal value ranking method addresses.</span></span>

## <a name="marginal-value-method"></a><span data-ttu-id="3318f-184">Aðferð jaðarvirðis</span><span class="sxs-lookup"><span data-stu-id="3318f-184">Marginal value method</span></span>

<span data-ttu-id="3318f-185">Til að leysa vandamál stigveldisvaxandi fjölda samsetninga sem þarf að meta, eru fínstillingar til staðar sem reikna virði á samnýttrar afurðar á hverja afsláttur á hóp afurða sem hægt er að nota tvær eða fleiri afslætti á.</span><span class="sxs-lookup"><span data-stu-id="3318f-185">To resolve the issue of an exponentially increasing number of combinations that must be evaluated, an optimization exists that calculates the value per shared product of each discount on the set of products that two or more discounts can be applied to.</span></span> <span data-ttu-id="3318f-186">Við vísum til þessa virðis sem **jaðarvirðis** afsláttar fyrir samnýttar afurðir.</span><span class="sxs-lookup"><span data-stu-id="3318f-186">We refer to this value as the **marginal value** of the discount for the shared products.</span></span> <span data-ttu-id="3318f-187">Jaðarvirði er meðaltal á afurðahækkun í heildarupphæð afsláttar þegar samnýttar afurðir eru taldar með fyrir hvern afslátt.</span><span class="sxs-lookup"><span data-stu-id="3318f-187">The marginal value is the average per product increase in the total discount amount when the shared products are included in each discount.</span></span> <span data-ttu-id="3318f-188">Jaðarvirði er reiknað með því að taka afsláttarupphæð samtals (DTotal), draga frá afsláttarupphæð án samnýtta afurðir (DMinus\\ Samnýttum), og deila þeim mismun með fjölda samnýtta afurða (ProductsShared).</span><span class="sxs-lookup"><span data-stu-id="3318f-188">The marginal value is calculated by taking the total discount amount (DTotal), subtracting the discount amount without the shared products (DMinus\\ Shared), and dividing that difference by the number of shared products (ProductsShared).</span></span>

![Samsetning afslátta sem skarast 06](./media/overlapping-discount-combo-06.jpg)

<span data-ttu-id="3318f-190">Eftir að jaðarvirði fyrir hvern afslátt á samnýtta hópa afurða hefur verið reiknað út, er afsláttum beitt á samnýttar afurðir í tæmandi röð frá hæsta jaðarvirði til lægsta jaðarvirðis.</span><span class="sxs-lookup"><span data-stu-id="3318f-190">After the marginal value of each discount on a shared set of products is calculated, the discounts are applied to the shared products in order, exhaustively, from highest marginal value to lowest marginal value.</span></span> <span data-ttu-id="3318f-191">Fyrir þessa aðferð eru allir eftirstandandi afsláttarmöguleikar ekki bornir saman í hvert skipti sem eitt tilvik afsláttar er sett á.</span><span class="sxs-lookup"><span data-stu-id="3318f-191">For this method, all remaining discount possibilities aren't compared every time after a single instance of a discount is applied.</span></span> <span data-ttu-id="3318f-192">Þess í stað eru afslættir sem skarast bornir saman einu sinni og síðan notað í röð.</span><span class="sxs-lookup"><span data-stu-id="3318f-192">Instead, the overlapping discounts are compared one time and then applied in order.</span></span> <span data-ttu-id="3318f-193">Enginn viðbótarsamanburður er gerður.</span><span class="sxs-lookup"><span data-stu-id="3318f-193">No additional comparisons are done.</span></span> <span data-ttu-id="3318f-194">Hægt er að skilgreina þröskuld til að skipta yfir í aðferð jaðarvirðis á flipanum **Afsláttur** á síðunni **Færibreytur Retail**.</span><span class="sxs-lookup"><span data-stu-id="3318f-194">You can configure the threshold to switch to the marginal value method on the **Discount** tab of the **Retail parameters** page.</span></span> <span data-ttu-id="3318f-195">Viðunandi tími til að reikna heildarafslátt er breytilegur milli atvinnugreina smásölu.</span><span class="sxs-lookup"><span data-stu-id="3318f-195">The acceptable time to calculate the total discount varies across retail industries.</span></span> <span data-ttu-id="3318f-196">Hins vegar er þessi tími almennt á bili tíu millisekúnda til einnar sekúndu.</span><span class="sxs-lookup"><span data-stu-id="3318f-196">However, this time generally falls in the range of tens of milliseconds to one second.</span></span>
